```{=html}
<!-- assets/ejs/posts_listing.ejs -->
<% 
  // ====================================================
  // GET PAGE SIZE FROM ITEM METADATA (From YAML config)
  // ====================================================
  let itemsPerPage = 6; // Default fallback
  
  if (items && items.length > 0) {
    // Get page-size from the first item's frontmatter metadata
    itemsPerPage = items[0]['page-size'] || 6;
  }
%>

<div class="blog-listing">
  <header class="blog-header">
    <% if (typeof title !== 'undefined') { %>
      <h1 class="blog-title"><%= title %></h1>
    <% } %>

    <% if (typeof description !== 'undefined') { %>
      <p class="blog-description"><%= description %></p>
    <% } %>
    
    <!-- Quarto: Add filters if categories exist -->
    <% if (typeof allCategories !== 'undefined' && allCategories.length > 0) { %>
      <div class="blog-filters">
        <button class="filter-btn active" data-filter="all">All Posts</button>
        <% allCategories.forEach(cat => { %>
          <button class="filter-btn" data-filter="<%= cat %>"><%= cat %></button>
        <% }) %>
      </div>
    <% } %>
  </header>

  <!-- Posts Grid -->
  <div class="posts-container">
    <% if (!items || items.length === 0) { %>
      <div class="no-posts">
        <i class="bi bi-journal-x"></i>
        <h3>No posts found</h3>
        <p>Check back soon for new articles.</p>
      </div>
    <% } else { %>
      <% items.forEach((post, index) => { %>
        <article class="blog-post <%= post.featured ? 'featured-post' : '' %>" 
                 data-categories="<%= post.categories ? post.categories.join(' ') : '' %>"
                 <% if (index >= itemsPerPage) { %>style="display: none;"<% } %>>
          
          <!-- Featured badge -->
          <% if (post.featured) { %>
            <div class="featured-badge">
              <i class="bi bi-star-fill"></i> Featured
            </div>
          <% } %>

          <!-- Thumbnail -->
          <div class="blog-thumbnail">
            <a href="<%- post.path %>" class="thumbnail-link" aria-label="Read <%= post.title %>">
              <img
                src="<%= post.image || '../../images/blogs/arts.jpg' %>"
                alt="<%= post.title %>"
                loading="lazy"
                onerror="this.src='../../images/blogs/arts.jpg'; this.onerror=null;"
              />
              <!-- Quarto: Add gradient overlay -->
              <div class="thumbnail-overlay"></div>
            </a>

            <!-- Category badges -->
            <% if (post.categories && post.categories.length > 0) { %>
              <div class="category-badges">
                <% post.categories.slice(0, 2).forEach(category => { %>
                  <span class="category-badge"><%= category %></span>
                <% }) %>
                <% if (post.categories.length > 2) { %>
                  <span class="category-badge more">+<%= post.categories.length - 2 %></span>
                <% } %>
              </div>
            <% } %>
          </div>

          <!-- Content -->
          <div class="blog-content">
            <!-- Meta -->
            <div class="blog-meta">
              <% if (post.date) { %>
                <span class="post-date">
                  <i class="bi bi-calendar3"></i>
                  <%= post.date %>
                </span>
              <% } %>

              <% if (post.readingTime) { %>
                <span class="reading-time">
                  <i class="bi bi-clock"></i>
                  <%= post.readingTime %> min
                </span>
              <% } %>

              <% if (post.author) { %>
                <span class="post-author">
                  <i class="bi bi-person"></i>
                  <%= post.author %>
                </span>
              <% } %>
            </div>

            <!-- Title -->
            <h2 class="blog-title">
              <a href="<%- post.path %>"><%= post.title %></a>
            </h2>

            <!-- Excerpt -->
            <% if (post.description) { %>
              <div class="blog-excerpt">
                <p><%= post.description %> <a href="<%- post.path %>" class="read-more-link">
                Read More <i class="bi bi-arrow-right"></i>
              </a></p>
              </div>
            <% } %>

            <!-- Footer 
            <div class="blog-footer">
              <a href="<%- post.path %>" class="read-more-link">
                Read More <i class="bi bi-arrow-right"></i>
              </a>
            </div>
            -->
          </div>
        </article>
      <% }) %>
    <% } %>
  </div>

  <!-- CUSTOM PAGINATION -->
  <% if (items && items.length > 0) { %>
    <% 
      const totalItems = items.length;
      const totalPages = Math.ceil(totalItems / itemsPerPage);
      
      if (totalPages > 1) {
        const blogPaginationId = 'blog-pag-' + Math.random().toString(36).substr(2, 9);
        
        // Get pagination style from frontmatter if available
        const paginationStyle = items[0]['pagination-style'] || 'default';
    %>
    
    <nav class="blog-pagination pagination publications-pagination <%= paginationStyle !== 'default' ? 'pagination-' + paginationStyle : '' %>" 
         aria-label="Publication navigation" 
         id="pagination-<%= blogPaginationId %>">
      <button type="button" 
              class="pagination-item pagination-item-prev disabled" 
              disabled
              aria-label="Previous page (disabled)">
        <i class="bi bi-chevron-left"></i>
        <span class="pagination-text">Prev</span>
      </button>
      
      <div class="pagination-numbers" id="numbers-<%= blogPaginationId %>"></div>
      
      <button type="button" 
              class="pagination-item pagination-item-next"
              aria-label="Go to next page">
        <span class="pagination-text">Next</span>
        <i class="bi bi-chevron-right"></i>
      </button>
    </nav>
    
    
    <script>
      (function() {
        const PAGE_SIZE = <%= itemsPerPage %>;
        const TOTAL_PAGES = <%= totalPages %>;
        const PAGINATION_ID = '<%= blogPaginationId %>';
        
        const paginationNav = document.getElementById('pagination-' + PAGINATION_ID);
        const listingContainer = paginationNav.closest('.blog-listing');
        const allItems = listingContainer.querySelectorAll('.blog-post');
        const numbersContainer = document.getElementById('numbers-' + PAGINATION_ID);
        const prevBtn = paginationNav.querySelector('.pagination-item-prev');
        const nextBtn = paginationNav.querySelector('.pagination-item-next');
        
        // Get current page from URL hash or default to 1
        let currentPage = 1;
        const hashMatch = window.location.hash.match(/blog-page=(\d+)/);
        if (hashMatch) {
          const pageFromHash = parseInt(hashMatch[1]);
          if (pageFromHash >= 1 && pageFromHash <= TOTAL_PAGES) {
            currentPage = pageFromHash;
          }
        }
        
        function showPage(pageNumber) {
          if (pageNumber < 1 || pageNumber > TOTAL_PAGES) return;
          
          // Hide all items
          allItems.forEach(item => {
            item.style.display = 'none';
            item.setAttribute('aria-hidden', 'true');
          });
          
          // Show items for current page
          const startIndex = (pageNumber - 1) * PAGE_SIZE;
          const endIndex = Math.min(startIndex + PAGE_SIZE, allItems.length);
          
          for (let i = startIndex; i < endIndex; i++) {
            allItems[i].style.display = '';
            allItems[i].setAttribute('aria-hidden', 'false');
          }
          
          currentPage = pageNumber;
          updateButtonStates();
          updatePageNumberButtons();
          updateAriaLabels();
          
          // Update URL without reloading
          const newUrl = window.location.pathname + '#blog-page=' + currentPage;
          window.history.replaceState({}, '', newUrl);
          
          // Scroll to top of posts container for better UX
          const postsContainer = listingContainer.querySelector('.posts-container');
          if (postsContainer && pageNumber > 1) {
            postsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        }
        
        function updateButtonStates() {
          // Update disabled states and classes
          const isFirstPage = currentPage === 1;
          const isLastPage = currentPage === TOTAL_PAGES;
          
          // Previous button
          prevBtn.disabled = isFirstPage;
          if (isFirstPage) {
            prevBtn.classList.add('disabled');
          } else {
            prevBtn.classList.remove('disabled');
          }
          
          // Next button
          nextBtn.disabled = isLastPage;
          if (isLastPage) {
            nextBtn.classList.add('disabled');
          } else {
            nextBtn.classList.remove('disabled');
          }
        }
        
        function updatePageNumberButtons() {
          numbersContainer.innerHTML = '';
          
          // Always show first page
          numbersContainer.appendChild(createPageButton(1));
          
          // Add ellipsis if needed before middle pages
          if (currentPage > 3) {
            numbersContainer.appendChild(createEllipsis());
          }
          
          // Show middle pages (current page Â± 1)
          const startPage = Math.max(2, currentPage - 1);
          const endPage = Math.min(TOTAL_PAGES - 1, currentPage + 1);
          
          for (let i = startPage; i <= endPage; i++) {
            numbersContainer.appendChild(createPageButton(i));
          }
          
          // Add ellipsis if needed after middle pages
          if (currentPage < TOTAL_PAGES - 2) {
            numbersContainer.appendChild(createEllipsis());
          }
          
          // Always show last page if there is more than one page
          if (TOTAL_PAGES > 1) {
            numbersContainer.appendChild(createPageButton(TOTAL_PAGES));
          }
        }
        
        function createPageButton(pageNum) {
          const button = document.createElement('button');
          button.type = 'button';
          button.className = 'pagination-item' + (pageNum === currentPage ? ' active' : '');
          button.textContent = pageNum;
          button.setAttribute('aria-label', 'Page ' + pageNum);
          button.setAttribute('aria-current', pageNum === currentPage ? 'page' : 'false');
          
          button.onclick = (e) => {
            e.preventDefault();
            showPage(pageNum);
          };
          
          return button;
        }
        
        function createEllipsis() {
          const ellipsis = document.createElement('span');
          ellipsis.className = 'pagination-item pagination-item-ellipsis';
          ellipsis.textContent = '...';
          ellipsis.setAttribute('aria-hidden', 'true');
          return ellipsis;
        }
        
        function updateAriaLabels() {
          // Update aria-label for previous and next buttons
          prevBtn.setAttribute('aria-label', 
            currentPage === 1 ? 'Previous page (disabled)' : 'Go to previous page, page ' + (currentPage - 1));
          nextBtn.setAttribute('aria-label', 
            currentPage === TOTAL_PAGES ? 'Next page (disabled)' : 'Go to next page, page ' + (currentPage + 1));
          
          // Update active page indicator
          const activeButton = numbersContainer.querySelector('.pagination-item.active');
          if (activeButton) {
            activeButton.setAttribute('aria-current', 'page');
          }
        }
        
        // Event listeners
        prevBtn.onclick = (e) => {
          e.preventDefault();
          if (currentPage > 1) showPage(currentPage - 1);
        };
        
        nextBtn.onclick = (e) => {
          e.preventDefault();
          if (currentPage < TOTAL_PAGES) showPage(currentPage + 1);
        };
        
        // Keyboard navigation
        paginationNav.addEventListener('keydown', (e) => {
          // Only handle if focus is within pagination
          if (!paginationNav.contains(document.activeElement)) return;
          
          switch(e.key) {
            case 'ArrowLeft':
              e.preventDefault();
              if (currentPage > 1) showPage(currentPage - 1);
              break;
            case 'ArrowRight':
              e.preventDefault();
              if (currentPage < TOTAL_PAGES) showPage(currentPage + 1);
              break;
            case 'Home':
              e.preventDefault();
              showPage(1);
              break;
            case 'End':
              e.preventDefault();
              showPage(TOTAL_PAGES);
              break;
            case 'Enter':
            case ' ':
              // Let default button behavior handle clicks
              break;
          }
        });
        
        // Initialize
        showPage(currentPage);
      })();
    </script>
    
    <% } // End if (totalPages > 1) %>
  <% } // End if (items && items.length > 0) %>
</div>
```