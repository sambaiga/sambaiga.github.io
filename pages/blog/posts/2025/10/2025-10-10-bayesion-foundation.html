<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anthony Faustine">
<meta name="dcterms.date" content="2025-10-10">
<meta name="description" content="Learn how Bayesian thinking can enhance decision-making in industrial applications. This article lay the foundation of bayesion modelling with Pymc and their practical use cases.">

<title>Understanding Bayesian Thinking for Industrial Applications ‚Äì Anthony Faustine</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../..//images/icons/favicon.ico" rel="icon">
<script src="../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-73b3ed812b94f25e5dd4fec30a4b4dd6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-e0bacbb98e503dc87d52d1333ade5d74.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/quarto-contrib/bootstrap-icons-1.13.1/bootstrap-icons.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(bayesion-01.jpg);
background-size: cover;
      }
</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Anthony Faustine">
<meta property="og:description" content="Lead Data Scientist at the Centre for Intelligent Power (CIP) at Eaton">
<meta property="og:image" content="https://sambaiga.github.io/pages/blog/posts/2025/10/posterior_sensitivity.svg">
<meta property="og:site_name" content="Anthony Faustine">
<meta property="og:locale" content="en_IE">
<meta name="twitter:title" content="Understanding Bayesian Thinking for Industrial Applications ‚Äì Anthony Faustine">
<meta name="twitter:description" content="Learn how Bayesian thinking can enhance decision-making in industrial applications. This article lay the foundation of bayesion modelling with Pymc and their practical use cases.">
<meta name="twitter:image" content="https://sambaiga.github.io/pages/blog/posts/2025/10/posterior_sensitivity.svg">
<meta name="twitter:creator" content="@asambaiga">
<meta name="twitter:site" content="@sambaiga">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Anthony Faustine</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../pages/about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../pages/blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../pages/publication/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:sambaiga@gmail.com"> 
<span class="menu-text"><i class="bi-envelope-at " style="font-size: 1.1em;" role="img" aria-hidden="true"></i><span class="visually-hidden">Email</span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/sambaiga" rel="me"> 
<span class="menu-text"><i class="bi-github " style="font-size: 1.1em;" role="img" aria-hidden="true"></i><span class="visually-hidden">GitHub</span></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/sambaiga" rel="me"> 
<span class="menu-text"><i class="bi-linkedin " style="font-size: 1.1em;" role="img" aria-hidden="true"></i><span class="visually-hidden">LinkedIn</span></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Understanding Bayesian Thinking for Industrial Applications</h1>
                  <div>
        <div class="description">
          Learn how Bayesian thinking can enhance decision-making in industrial applications. This article lay the foundation of bayesion modelling with Pymc and their practical use cases.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">python</div>
                <div class="quarto-category">bayesian</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://sambaiga.github.io/">Anthony Faustine</a> <a href="https://orcid.org/0000-0002-3948-3914" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              CIP, Eaton Corporation, Dublin Ireland.
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 10, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#the-building-blocks-of-bayesian-modeling" id="toc-the-building-blocks-of-bayesian-modeling" class="nav-link" data-scroll-target="#the-building-blocks-of-bayesian-modeling">The Building Blocks of Bayesian modeling</a></li>
  <li><a href="#case-study-ab-testing-with-small-samples" id="toc-case-study-ab-testing-with-small-samples" class="nav-link" data-scroll-target="#case-study-ab-testing-with-small-samples">Case study: A/B Testing with Small Samples</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model diagnostics</a></li>
  <li><a href="#prior-predictive-checks-validating-model-assumptions" id="toc-prior-predictive-checks-validating-model-assumptions" class="nav-link" data-scroll-target="#prior-predictive-checks-validating-model-assumptions">Prior Predictive Checks: Validating Model Assumptions</a></li>
  <li><a href="#model-utility-and-business-decision" id="toc-model-utility-and-business-decision" class="nav-link" data-scroll-target="#model-utility-and-business-decision">Model Utility and Business Decision</a></li>
  <li><a href="#common-bayesian-pitfalls-and-best-practices" id="toc-common-bayesian-pitfalls-and-best-practices" class="nav-link" data-scroll-target="#common-bayesian-pitfalls-and-best-practices">Common bayesian pitfalls and best practices</a></li>
  <li><a href="#next-steps-in-the-bayesian-journey" id="toc-next-steps-in-the-bayesian-journey" class="nav-link" data-scroll-target="#next-steps-in-the-bayesian-journey">Next steps in the bayesian journey</a></li>
  <li><a href="#resources-to-continue-learning" id="toc-resources-to-continue-learning" class="nav-link" data-scroll-target="#resources-to-continue-learning">Resources to continue learning</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>A company has recently installed a new, expensive machine. A critical question arises: <em>How long will it last before failure</em>?. The lead engineer, drawing on experience with previous models, estimates a lifespan of approximately 10 years. However, only 3 months of real-world test data are available for this specific unit, and a major warranty and service contract decision must be made immediately.</p>
<p>This scenario exemplifies a common challenge in industrial applications: <strong>making informed decisions with limited data</strong>. Bayesian thinking offers a powerful framework to address such problems by combining prior knowledge with observed data to update our beliefs about uncertain parameters.</p>
<p>In this article, we will explore the fundamentals of Bayesian thinking and how it can be applied to industrial scenarios like the one described above. We will cover key concepts such as prior distributions, likelihood functions, and posterior distributions, and demonstrate how to implement Bayesian models using Python‚Äôs <a href="https://www.pymc.io/welcome.html">PyMC library</a>.</p>
<p>To immediately dive into the code and reproduce the models discussed in this article, you can use our accompanying resources:</p>
<ol type="1">
<li><p>Repository: Fork <a href="https://github.com/sambaiga/bayesian-modelling/tree/main">bayesian-modelling repository</a> and follow the setup instructions in the <a href="https://github.com/sambaiga/bayesian-modelling/tree/main">README.md</a> file.</p></li>
<li><p>Notebook: Launch <a href="https://github.com/sambaiga/bayesian-modelling/blob/main/notebook/bayesian-modelling-01.ipynb">the bayesian-modelling-01.ipynb</a> notebook located in the notebook folder to follow along step-by-step.</p></li>
</ol>
</section>
<section id="the-building-blocks-of-bayesian-modeling" class="level3">
<h3 class="anchored" data-anchor-id="the-building-blocks-of-bayesian-modeling">The Building Blocks of Bayesian modeling</h3>
<p>Traditional (Frequentist) statistics relies on large datasets the ‚Äúlong run‚Äù to produce confident conclusions, a limitation in industrial contexts where data are often sparse. New products, machines, or processes typically generate only small samples, while valuable expert knowledge such as an engineer‚Äôs lifespan estimate is excluded from conventional models.</p>
<p>Bayesian inference overcomes these issues by combining <strong>prior knowledge</strong> with <strong>new data</strong>, enabling faster and more informed decisions when information is limited. This integration of expertise and evidence defines Bayesian thinking.</p>
<p>The process of updating our beliefs is formalized by Bayes‚Äô Theorem. <span class="math display">
P(\theta \mid D) = \frac{P(D \mid \theta) P(\theta)}{P(D)}
</span></p>
<p>While the formula looks mathematical, its components represent a beautifully intuitive learning cycle.</p>
<p><span class="math display">
\mathrm{Posterior} \propto \mathrm{Likelihood} \times \mathrm{Prior}
</span></p>
<p>Let us break down how this relates to our machine failure problem; where <span class="math inline">\theta</span> is the machine‚Äôs expected failure rate, and <span class="math inline">D</span> is the 3 months of test data.</p>
<section id="prior-likelihood-and-posterior" class="level4">
<h4 class="anchored" data-anchor-id="prior-likelihood-and-posterior">Prior, Likelihood, and Posterior</h4>
<ol type="1">
<li><p><strong>Prior</strong> <span class="math inline">P(\theta)</span> represents the initial belief before observing any data. It incorporates domain expertise and historical knowledge. For instance, historical records may indicate that similar machines have an average lifespan of approximately ten years, implying a low failure rate. This prior belief defines the starting point for ùúÉ <span class="math inline">\theta</span>.</p></li>
<li><p><strong>Likelihood</strong> <span class="math inline">P(D \mid \theta)</span> quantifies the compatibility between the observed data and a given parameter value. It expresses the probability of observing the test outcomes for different possible failure rates. In this context, the likelihood measures how probable it is to observe zero failures within three months if the true average lifespan were, for example, five or fifteen years.</p></li>
<li><p><strong>Posterior</strong> <span class="math inline">P(\theta \mid D)</span> represents the updated belief after incorporating the observed data. It integrates prior knowledge with the evidence provided by the likelihood. In the machine-failure example, the posterior distribution expresses the updated estimate of expected lifespan after combining historical information (e.g., the ten-year prior) with the three months of failure-free operational data.</p></li>
</ol>
</section>
<section id="pymc-the-probabilistic-programming-engine" class="level4">
<h4 class="anchored" data-anchor-id="pymc-the-probabilistic-programming-engine">PyMC: The Probabilistic Programming Engine</h4>
<p>Understanding the relationship <span class="math inline">\mathrm{Posterior} \propto \mathrm{Likelihood} \times \mathrm{Prior}</span> is the conceptual heart of Bayesian analysis. However, calculating the actual posterior distribution, <span class="math inline">P(\theta \mid D)</span>, often involves complex, multi-dimensional integration that is impossible to solve analytically for real-world industrial problems. This challenge is addressed through Probabilistic Programming Languages (PPLs) such as PyMC.</p>
<p><a href="https://www.pymc.io/welcome.html">PyMC</a> is an open-source Python library for constructing and fitting Bayesian statistical models using advanced computational algorithms, including Markov Chain Monte Carlo (MCMC) and variational inference. It is one of several modern PPLs available in Python, alongside <a href="https://pyro.ai/">Pyro</a> and <a href="https://www.tensorflow.org/probability">TensorFlow Probability (TFP)</a>. This tutorial focuses on PyMC due to its clarity, community support, and extensive documentation.</p>
</section>
</section>
<section id="case-study-ab-testing-with-small-samples" class="level3">
<h3 class="anchored" data-anchor-id="case-study-ab-testing-with-small-samples">Case study: A/B Testing with Small Samples</h3>
<p>To shift from theory to practical implementation, we will apply the Bayesian building blocks Prior, Likelihood, and Posterior to a concrete industrial problem common in tech and e-commerce: A/B Testing</p>
<blockquote class="blockquote">
<p>Suppose you are a data scientist at an e-commerce company. The marketing team just launched a new website feature and wants to know:</p>
</blockquote>
<ol type="1">
<li><p>What‚Äôs the true conversion rate?</p></li>
<li><p>Is it better than the old version (which historically has an 8% conversion rate)?</p></li>
<li><p>How much should we trust this estimate with limited data?</p></li>
</ol>
<blockquote class="blockquote">
<p>During the first few days of the feature launch, the company has observed 200 visitors with only 15 conversion.</p>
</blockquote>
<section id="library-imports" class="level4">
<h4 class="anchored" data-anchor-id="library-imports">Library Imports</h4>
<p>Import the required Python libraries for Bayesian modeling:</p>
<ul>
<li>NumPy for numerical computations</li>
<li>Pandas for data manipulation</li>
<li>PyMC for Bayesian statistical modeling</li>
<li>Matplotlib, arviz and altair for visualization</li>
</ul>
<div id="10" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> warnings</span>
<span id="cb1-3"><a href="#cb1-3"></a>warnings.filterwarnings(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">UserWarning</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pymc <span class="im">as</span> pm</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> IPython.display <span class="im">import</span> clear_output</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> great_tables <span class="im">import</span> GT</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-11"><a href="#cb1-11"></a>az.style.use(<span class="st">"arviz-white"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">from</span> cycler <span class="im">import</span> cycler</span>
<span id="cb1-13"><a href="#cb1-13"></a>colors<span class="op">=</span>[<span class="st">'#107591'</span>,<span class="st">'#f69a48'</span>,<span class="st">'#00c0bf'</span>, <span class="st">'#fdcd49'</span>,<span class="st">"#cf166e"</span>, </span>
<span id="cb1-14"><a href="#cb1-14"></a>        <span class="st">"#7035b7"</span>, <span class="st">"#212121"</span>,<span class="st">"#757575"</span>, <span class="st">"#E0E0E0"</span>,<span class="st">"#FAFAFA"</span>]</span>
<span id="cb1-15"><a href="#cb1-15"></a>plt.rcParams.update({</span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="st">"figure.dpi"</span>: <span class="dv">100</span>,</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="st">"axes.labelsize"</span>: <span class="dv">12</span>,</span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="st">"axes.titlesize"</span>: <span class="dv">12</span>,</span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="st">"figure.titlesize"</span>: <span class="dv">12</span>,</span>
<span id="cb1-20"><a href="#cb1-20"></a>        <span class="st">"font.size"</span>: <span class="dv">12</span>,</span>
<span id="cb1-21"><a href="#cb1-21"></a>        <span class="st">"legend.fontsize"</span>: <span class="dv">12</span>,</span>
<span id="cb1-22"><a href="#cb1-22"></a>        <span class="st">"xtick.labelsize"</span>: <span class="dv">12</span>,</span>
<span id="cb1-23"><a href="#cb1-23"></a>        <span class="st">"ytick.labelsize"</span>: <span class="dv">12</span>,</span>
<span id="cb1-24"><a href="#cb1-24"></a>        <span class="st">"axes.linewidth"</span> : <span class="fl">0.5</span>,</span>
<span id="cb1-25"><a href="#cb1-25"></a>        <span class="st">"lines.linewidth"</span> : <span class="fl">1.</span>,</span>
<span id="cb1-26"><a href="#cb1-26"></a>        <span class="st">"legend.frameon"</span> :<span class="va">False</span>,</span>
<span id="cb1-27"><a href="#cb1-27"></a>        <span class="st">'axes.prop_cycle'</span>: cycler(color<span class="op">=</span>colors)</span>
<span id="cb1-28"><a href="#cb1-28"></a>        </span>
<span id="cb1-29"><a href="#cb1-29"></a>})</span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="im">import</span> altair </span>
<span id="cb1-31"><a href="#cb1-31"></a>altair.themes.enable(<span class="st">'carbonwhite'</span>)</span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb1-33"><a href="#cb1-33"></a>alt.data_transformers.enable(<span class="st">'default'</span>, max_rows<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb1-34"><a href="#cb1-34"></a>clear_output()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="define-key-variables-and-parameters" class="level5">
<h5 class="anchored" data-anchor-id="define-key-variables-and-parameters">Define key variables and parameters</h5>
<div id="12" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># For reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># A/B Test Parameters</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>visitors <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>conversions <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>observed_conversion_rate <span class="op">=</span> conversions <span class="op">/</span> visitors</span>
<span id="cb2-8"><a href="#cb2-8"></a>historical_baseline <span class="op">=</span> <span class="fl">0.08</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="define-prior-likelihood-and-posterior-in-pymc" class="level4">
<h4 class="anchored" data-anchor-id="define-prior-likelihood-and-posterior-in-pymc">Define Prior, likelihood, and Posterior in PyMC</h4>
<p>To model this problem in PyMC, one must first define the Prior and Likelihood distributions</p>
<p><strong>Prior</strong>: Since the conversion rate <span class="math inline">\theta</span>, can only range between 0 and 1. The Beta distribution is ideal for modeling parameters that are bounded between 0 and 1, such as probabilities or rates.</p>
<p>The Beta distribution is controlled by two parameters, <span class="math inline">\alpha</span> and <span class="math inline">\beta</span>. hese parameters are set to formally encode the prior knowledge: the historical 8% conversion rate. The mean of a <span class="math inline">\mathrm{Beta}(\alpha,\beta)</span> distribution is <span class="math inline">\frac{\alpha}{ \alpha + \beta}</span>. Since the historical rate is 8% (or 0.08), we need to choose <span class="math inline">\alpha</span> and <span class="math inline">\beta</span> such that: <span class="math display">
\frac{\alpha}{ \alpha + \beta} = 0.08
</span></p>
<p>To determine the strength of this belief, a number that represents the effective sample size (ESS) of the historical knowledge is chosen. Choosing a hypothetical ESS of 100 trials, we can solve for <span class="math inline">\alpha</span> and <span class="math inline">\beta</span>: - ESS <span class="math inline">= \alpha + \beta = 100</span> - <span class="math inline">\alpha</span> (hypothetical successes) <span class="math inline">=100√ó0.08=8</span> - <span class="math inline">\beta</span> (hypothetical failures) <span class="math inline">=100‚àí8=92</span></p>
<p><strong>Likelihood</strong> the Likelihood is determined by the process that generated the data. Since there is a fixed number of trials (N=200 visitors) and the number of successes (k=15 conversions) is counted, this is a Binomial distribution.</p>
<div id="14" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> conversion_model:</span>
<span id="cb3-2"><a href="#cb3-2"></a>    <span class="co"># Prior distribution based on historical performance</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>    conversion_rate <span class="op">=</span> pm.Beta(<span class="st">"conversion_rate"</span>, alpha<span class="op">=</span><span class="dv">8</span>, beta<span class="op">=</span><span class="dv">92</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>    </span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="co"># Likelihood function</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    likelihood <span class="op">=</span> pm.Binomial(<span class="st">"observations"</span>, n<span class="op">=</span>visitors, p<span class="op">=</span>conversion_rate, observed<span class="op">=</span>conversions)</span>
<span id="cb3-7"><a href="#cb3-7"></a>    </span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="co"># Sample from posterior distribution</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>    trace <span class="op">=</span> pm.sample(<span class="dv">2000</span>, tune<span class="op">=</span><span class="dv">1000</span>, chains<span class="op">=</span><span class="dv">4</span>, random_seed<span class="op">=</span><span class="dv">42</span>, return_inferencedata<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a>clear_output()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>This small block of code above defines and runs our entire Bayesian analysis. For those seeing PyMC for the first time, here is what each section is doing:</p>
<ol type="1">
<li><p><code>with pm.Model() as model:</code> This block acts as a container for all the random variables and data in our model. Everything inside this context belongs to the conversion_model</p></li>
<li><p><code>conversion_rate = pm.Beta(...)</code>: We are telling PyMC that the true conversion_rate is a random variable, and our initial belief is described by the Beta(8,92) distribution.</p></li>
<li><p><code>likelihood = pm.Binomial(...)</code>: This defines the process that generated our observed data. We link the conversion_rate parameter to the actual observed data (n=visitors, observed=conversions) using the appropriate Binomial distribution.</p></li>
<li><p><code>pm.sample(...)</code>: This is where the magic happens! The pm.sample function runs the MCMC sampler (the computational engine) to combine the Prior and the Likelihood, effectively calculating the Posterior distribution. We ask the sampler to draw 2000 samples after a 1000-sample tuning period, running 4 independent chains to ensure reliable results.</p></li>
</ol>
</section>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model diagnostics</h3>
<p>Running <code>pm.sample()</code> generates the raw output, but the job isn‚Äôt done yet. Before we trust the results, we must perform Model Diagnostics to ensure our computational engine (the MCMC sampler) has worked correctly. The single most important diagnostic check is confirming Convergence.</p>
<section id="model-convergencevergence" class="level4">
<h4 class="anchored" data-anchor-id="model-convergencevergence">Model Convergencevergence</h4>
<p>In Bayesian inference, Markov Chain Monte Carlo (MCMC) methods are employed to sample from the complex posterior distribution. These samples are relied upon to accurately estimate quantities like the mean conversion rate or its credible interval.</p>
<p><strong>Convergence</strong> is the guarantee that the MCMC chains have explored the entire distribution and are now producing samples that truly represent the target Posterior distribution, and are not just stuck in a starting location.</p>
<blockquote class="blockquote">
<p><strong>Analogy</strong>: Imagine trying to understand the shape of a deep, misty valley (the posterior). If your chains haven‚Äôt converged, they might be stuck high up on a ridge, missing the true, deep center. Diagnostics are the tools we use to confirm the chains have found and are walking across the bottom of the true valley.</p>
</blockquote>
<p>PyMC uses the supporting library <a href="https://www.arviz.org/en/latest/">ArviZ</a> for standardizing and analyzing the results, which provides the following diagnostics and plots</p>
<ol type="1">
<li><p>Trace Plots: Visual inspection of parameter samples across iterations.</p>
<ul>
<li>Good trace plots look like <em>fuzzy caterpillars</em> with no trends or jumps.</li>
</ul></li>
<li><p>R-hat (Gelman-Rubin Statistic): Measures how well multiple chains agree.</p>
<ul>
<li>R-hat ‚âà 1 means convergence.</li>
<li>R-hat &gt; 1.01 suggests problems.</li>
</ul></li>
<li><p>Effective Sample Size (ESS): Indicates how many independent samples you effectively have.</p>
<ul>
<li>Low ESS means poor mixing or autocorrelation. Good ESS is typically &gt; 200 per parameter.</li>
</ul></li>
</ol>
<p>The most efficient way to check convergence numerically is using the ArviZ summary function, specifically asking for the diagnostics <code>az.summary(trace, kind="diagnostics")</code>. Alternatively, <code>az.plot_trace(trace)</code> can be used to get a visual sense of convergence.</p>
<section id="example-diagnostic-output" class="level5">
<h5 class="anchored" data-anchor-id="example-diagnostic-output">Example Diagnostic Output</h5>
<div id="20" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>diag_table<span class="op">=</span>az.summary(trace, kind<span class="op">=</span><span class="st">"diagnostics"</span>)[[<span class="st">'ess_bulk'</span>, <span class="st">'ess_tail'</span>, <span class="st">'r_hat'</span>]]</span>
<span id="cb4-2"><a href="#cb4-2"></a>GT(diag_table).tab_header(</span>
<span id="cb4-3"><a href="#cb4-3"></a>    title<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>    subtitle<span class="op">=</span><span class="st">"Conversion Rate Model"</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>).cols_label({</span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="st">'ess_bulk'</span>: <span class="st">'ESS Bulk'</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>        <span class="st">'ess_tail'</span>: <span class="st">'ESS Tail.'</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>        <span class="st">'r_hat'</span>: <span class="st">'R-hat'</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>    })</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>This table immediately indicates that the model is reliable and ready for analysis</p>
<ul>
<li><p>(R_hat = 1.0,Goal Achieved): Since R_hat is exactly 1.0, this confirms that the four independent MCMC chains have fully converged and agree on the shape of the posterior distribution. The model is reliable.</p></li>
<li><p>ESS bulk ‚Äãand ESS tail (3966.0 and 5559.0, Goal Achieved): Both effective sample sizes are significantly greater than the ‚â•400 minimum threshold. This means there are plenty of high-quality, effectively independent samples to accurately estimate the mean, mode, and credible intervals of the true conversion rate.</p></li>
</ul>
<section id="visual-check-trace-plots" class="level6">
<h6 class="anchored" data-anchor-id="visual-check-trace-plots">Visual Check: Trace Plots</h6>
<p>While the numbers in the summary table are essential, visually inspecting the MCMC chains confirms the story.</p>
<div id="23" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>az.plot_trace(trace)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>The trace plot above shows excellent convergence for our conversion rate (<span class="math inline">\theta</span>) model, supporting the conclusions from our quantitative diagnostics. The plot is split into two panels 1. Right Panel: MCMC Sampling Behavior</p>
<ul>
<li>This panel shows the raw sampled values across iterations for each of our four chains. The sampled values oscillate stably around ‚àº0.075 (7.5%) without any noticeable trends, sudden jumps, or long-term drifts.</li>
<li>The different lines (chains) are thoroughly intertwined and overlap completely. This ‚Äúfuzzy caterpillar‚Äù appearance is the visual proof that the sampler is efficiently exploring the parameter space and that all chains have converged to the same distribution.</li>
<li>The stable behavior confirms the chain has reached <strong>stationarity</strong>, meaning it is now sampling from the true, converged Posterior distribution.</li>
</ul>
<ol start="2" type="1">
<li><p>Left Panel: Posterior Distribution</p>
<ul>
<li>This panel shows the estimated Posterior probability density function (PDF) based on the samples. The shape is smooth and unimodal (single peak), indicating a well-behaved posterior without ambiguity.</li>
<li>The peak is clearly centered at a value close to our observed rate (7.5%), which is what we expect when combining a prior (8%) and data (7.5%).</li>
<li>The spread of the distribution clearly visualizes our remaining uncertainty about the true conversion rate.</li>
</ul></li>
</ol>
</section>
</section>
</section>
</section>
<section id="prior-predictive-checks-validating-model-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="prior-predictive-checks-validating-model-assumptions">Prior Predictive Checks: Validating Model Assumptions</h3>
<p>While we have demonstrated that the convergence of the fitted model a complete Bayesian analysis requires us to first validate the assumptions we made before seeing any data (priors). This validation is accomplished through the Prior Predictive Check.</p>
<blockquote class="blockquote">
<p>Prior Predictive Checks helps validate the prior assumptions before fitting the model to data. It show what kind of data the model expects to generate based solely on the prior beliefs.</p>
</blockquote>
<div id="26" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> conversion_model:</span>
<span id="cb6-2"><a href="#cb6-2"></a>    <span class="co"># Prior distribution based on historical performance</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>    conversion_rate <span class="op">=</span> pm.Beta(<span class="st">"conversion_rate"</span>, alpha<span class="op">=</span><span class="dv">8</span>, beta<span class="op">=</span><span class="dv">92</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>    </span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="co"># Likelihood function</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>    likelihood <span class="op">=</span> pm.Binomial(<span class="st">"observations"</span>, n<span class="op">=</span>visitors, p<span class="op">=</span>conversion_rate, observed<span class="op">=</span>conversions)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Given our prior belief of an 8% conversion rate, we can simulate what kind of data we would expect to see if this belief were true. This is done by generating synthetic datasets from the prior distribution and comparing them to the actual observed data. This is acomplished in PyMC by running <code>pm.sample_prior_predictive()</code> function.</p>
<div id="28" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">with</span> conversion_model:</span>
<span id="cb7-2"><a href="#cb7-2"></a>    prior_pred <span class="op">=</span> pm.sample_prior_predictive()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="29" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>fig, ax<span class="op">=</span>plt.subplots(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="fl">2.8</span>))</span>
<span id="cb8-2"><a href="#cb8-2"></a>az.plot_ppc(prior_pred, group<span class="op">=</span><span class="st">"prior"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb8-3"><a href="#cb8-3"></a>plt.xlabel(<span class="st">'conversions'</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>plt.ylabel(<span class="st">'Density'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>The generated plot from the prior predictive sampling shows the distributions of simulated data (the number of conversions) created by sampling from the <span class="math inline">\text{Beta}(8,92)</span> prior distribution. - The distribution of the simulated data (prior predictive line) appear broadly spread out and relatively flat across a wide range (0 to 40+ conversions). This indicates that the prior allows for many different outcomes, and thus it is not overly restrictive. - The dashed line represents the average predicted number of conversions It is also quite flat and non-committal. - It evident that the prior predictive distribution does not overly concentrate around any specific number of conversions, which is desirable when we want to remain open to various possible outcomes. - So the prior predictive check confirms that our chosen Beta(8,92) prior is reasonable though it also quite weakly informative how?</p>
<p><strong>Red flags to watch for:</strong></p>
<ul>
<li><p><strong>Impossible values</strong>: Predictions outside the feasible range (e.g., negative conversion, &gt;200 observations)</p></li>
<li><p><strong>Unrealistic concentrations</strong>: If priors are too informative, you might see all predictions clustered in a narrow range</p></li>
<li><p><strong>Poor scaling</strong>: Predictions that don‚Äôt match the scale of your problem</p></li>
</ul>
<section id="posterior-predictive-checks" class="level4">
<h4 class="anchored" data-anchor-id="posterior-predictive-checks">Posterior Predictive Checks</h4>
<p>Posterior Predictive Checks addresses the important test: Does the model actually make sense given the data observed?</p>
<p>This moves the process from confirming the samplers or priors to validating the model itself.</p>
<blockquote class="blockquote">
<p>PPCs evaluate model fit by comparing the observed data to simulated data from the posterior distribution. If a model accurately represents the data-generating process, the simulated data should resemble the actual observations.</p>
</blockquote>
<p>To achive this it is important to generate new, simulated data from the posterior distribution and compare it to the actual observed data. This is done using the <code>pm.sample_posterior_predictive</code> function in PyMC.</p>
<div id="36" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> conversion_model:</span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="co"># Prior distribution based on historical performance</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    conversion_rate <span class="op">=</span> pm.Beta(<span class="st">"conversion_rate"</span>, alpha<span class="op">=</span><span class="dv">8</span>, beta<span class="op">=</span><span class="dv">92</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>    </span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="co"># Likelihood function</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>    likelihood <span class="op">=</span> pm.Binomial(<span class="st">"observations"</span>, n<span class="op">=</span>visitors, p<span class="op">=</span>conversion_rate, observed<span class="op">=</span>conversions)</span>
<span id="cb9-7"><a href="#cb9-7"></a>    </span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="co"># Sample from posterior distribution</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>    trace <span class="op">=</span> pm.sample(<span class="dv">2000</span>, tune<span class="op">=</span><span class="dv">1000</span>, chains<span class="op">=</span><span class="dv">4</span>, random_seed<span class="op">=</span><span class="dv">42</span>, return_inferencedata<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="cf">with</span> conversion_model:</span>
<span id="cb9-13"><a href="#cb9-13"></a>    posterior_pred <span class="op">=</span> pm.sample_posterior_predictive(trace, random_seed<span class="op">=</span><span class="dv">42</span>,)</span>
<span id="cb9-14"><a href="#cb9-14"></a>    </span>
<span id="cb9-15"><a href="#cb9-15"></a>clear_output()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="37" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>ppc_summary <span class="op">=</span> az.summary(posterior_pred, kind<span class="op">=</span><span class="st">'stats'</span>, hdi_prob<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>ppc_table <span class="op">=</span> (</span>
<span id="cb10-3"><a href="#cb10-3"></a>    GT(ppc_summary)</span>
<span id="cb10-4"><a href="#cb10-4"></a>    .cols_label({</span>
<span id="cb10-5"><a href="#cb10-5"></a>        <span class="st">'mean'</span>: <span class="st">'Mean'</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>        <span class="st">'sd'</span>: <span class="st">'Std-Dev.'</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>        <span class="st">'hdi_2.5%'</span>: <span class="st">'HDI 3%'</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>        <span class="st">'hdi_97.5%'</span>: <span class="st">'HDI 97%'</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>    }).tab_header(</span>
<span id="cb10-10"><a href="#cb10-10"></a>        title<span class="op">=</span><span class="st">"Posterior Predictive Summary Statistics"</span>,</span>
<span id="cb10-11"><a href="#cb10-11"></a>        subtitle<span class="op">=</span><span class="st">""</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>    )</span>
<span id="cb10-13"><a href="#cb10-13"></a>)</span>
<span id="cb10-14"><a href="#cb10-14"></a>ppc_table </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>It clear that the predicted mean (15.314) is extremely close to the actual observed count (15). This is a strong indication that the <code>conversion_rate model</code> fits the data very well. And thus the choice of the Beta Prior and Binomial Likelihood is appropriate for this data. The model predicts that 95% of the time, the number of conversions will fall between 6 and 24. Since the company observed value of 15 falls well within this 95% HDI, the actual observation is considered highly plausible according to your model.</p>
<div id="39" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>ppc_samples <span class="op">=</span> posterior_pred.posterior_predictive[<span class="st">'observations'</span>].values.flatten()</span>
<span id="cb11-2"><a href="#cb11-2"></a>percentile <span class="op">=</span> (ppc_samples <span class="op">&lt;=</span> conversions).mean() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="bu">print</span>(<span class="ss">f"Observed convervation (</span><span class="sc">{</span>conversions<span class="sc">}</span><span class="ss">) is at the </span><span class="sc">{</span>percentile<span class="sc">:.1f}</span><span class="ss">th percentile of predictions"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>The value of 53.7 is very close to the ideal 50, which provides further strong evidence (in addition to the mean of 15.314 already seen) that:</p>
<ul>
<li><p>The model is not biased (it is not systematically over- or under-estimating the data).</p></li>
<li><p>The choice of the Beta-Binomial model is highly appropriate for this data set.</p></li>
</ul>
</section>
</section>
<section id="model-utility-and-business-decision" class="level3">
<h3 class="anchored" data-anchor-id="model-utility-and-business-decision">Model Utility and Business Decision</h3>
<p>Following the confirmation of the reliability of the Bayesian model through the Posterior Predictive Check (PPC), the focus now shifts from ‚ÄúDoes the model fit the data?‚Äù to the commercially critical question: ‚ÄúIs the model useful for making business decisions?‚Äù</p>
<p>Specifically, the derived posterior distribution is utilized to quantify the evidence that the new feature‚Äôs conversion rate (Feature B) is superior to the existing, established conversion rate (Feature A, which has a known baseline rate of 0.08).</p>
<p>To achieve this, we need to extract the posterior distribution for the conversion_rate parameter that your model estimated.</p>
<div id="44" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>posterior_samples <span class="op">=</span> trace.posterior.stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb12-2"><a href="#cb12-2"></a>conversion_samples<span class="op">=</span>posterior_samples[<span class="st">'conversion_rate'</span>].values</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Next, calculate the ‚Äúprobability of superiority‚Äù‚Äîthe probability that the new feature (B) is better than the old (A).</p>
<p>Finally, the expected uplift in conversion rate can be computed and translated into business value. This involves calculating the difference between the posterior mean conversion rate and the historical rate, then multiplying by the number of visitors and average revenue per conversion.</p>
<ul>
<li><p>0.95: Strong Evidence. The new feature is very likely superior. Launching it should be considered.</p></li>
<li><p>0.80: Moderate Evidence. The new feature is likely better, but there is still a 20% chance it is worse. The decision depends on company risk tolerance.</p></li>
<li><p>0.50: No Evidence. The new feature is a toss-up; there is no statistical reason to prefer it over the old feature.</p></li>
</ul>
<div id="46" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>prob_superiority <span class="op">=</span> (conversion_samples <span class="op">&gt;</span> historical_baseline).mean()</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># Display the result</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="bu">print</span>(<span class="ss">f"The probability that the new feature is better than the old rate (0.08) is: </span><span class="sc">{</span>prob_superiority<span class="sc">:.1%}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>The calculated Probability of Superiority is approximately 0.40, indicating that there is a 40% chance the new feature‚Äôs conversion rate is better than the old feature‚Äôs with 8% rate. This imply that there is a 60.3% chance the new feature is worse than the baseline.</p>
<p>Since the probability that the new feature is superior is well below the neutral benchmark of 50%, the data does not support replacing the existing Feature A with the new Feature B based on conversion rate alone. The new feature is highly likely to perform worse.</p>
<section id="probability-of-meaningful-improvement." class="level5">
<h5 class="anchored" data-anchor-id="probability-of-meaningful-improvement.">Probability of Meaningful Improvement.</h5>
<p>Depending on the business context, one might also want to calculate the probability that the new feature is better by a meaningful margin (e.g., &gt;1% improvement). This calculates the chance that the new feature is better than the old feature by a practically significant margin of at least 1 percentage point. This is a crucial business metric. Sometimes a tiny statistical ‚Äúwin‚Äù is not worth the cost of development and deployment. If this probability is low, it confirms the feature is not a major improvement.</p>
<div id="49" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>prob_1pct_improvement <span class="op">=</span> (conversion_samples <span class="op">&gt;</span> historical_baseline<span class="op">+</span><span class="fl">0.01</span>).mean()</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="bu">print</span>(<span class="ss">f" Probability of &gt;1% improvement: </span><span class="sc">{</span>prob_1pct_improvement<span class="sc">:.1%}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="probability-of-hitting-a-target-rate" class="level4">
<h4 class="anchored" data-anchor-id="probability-of-hitting-a-target-rate">Probability of Hitting a Target Rate</h4>
<p>This calculates the chance that the true conversion rate of the new feature is 10% or higher. This is useful if 10% is a specific, ambitious KPI (Key Performance Indicator) or goal set by the marketing or product team. It tells how likely the team is to meet its goal.</p>
<div id="51" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>prob_10pct <span class="op">=</span> (conversion_samples <span class="op">&gt;</span> <span class="fl">0.10</span>).mean()</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="bu">print</span>(<span class="ss">f" Probability of &gt;10% improvement: </span><span class="sc">{</span>prob_10pct<span class="sc">:.1%}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="expected-value-of-the-change." class="level5">
<h5 class="anchored" data-anchor-id="expected-value-of-the-change.">Expected Value of the Change.</h5>
<p>This is the single-number best estimate of the average change (positive or negative) to expect upon deploying the new feature. This is the foundation for the ‚ÄúExpected Business Impact‚Äù section. If this value is negative, it represents an Expected Loss.</p>
<p>If one calculates: expected_uplift√óTotal&nbsp;Visitors√óARPC, the estimated dollar value of the change is obtained.</p>
<p>The goal is to translate the statistically determined average change in conversion rate into a clear financial outcome for the business. This calculation provides the most actionable insight for the go/no-go decision on the new feature.</p>
<div id="53" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Calculate key business probabilities</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>expected_uplift <span class="op">=</span> conversion_samples.mean() <span class="op">-</span> historical_baseline</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Calculate expected business impact</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>monthly_visitors <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>expected_additional_conversions <span class="op">=</span> monthly_visitors <span class="op">*</span> expected_uplift</span>
<span id="cb16-7"><a href="#cb16-7"></a>conversion_value <span class="op">=</span> <span class="dv">50</span>  <span class="co"># Average value per conversion</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>expected_monthly_value <span class="op">=</span> expected_additional_conversions <span class="op">*</span> conversion_value</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="bu">print</span>(<span class="ss">f"Expected uplift: </span><span class="sc">{</span>expected_uplift<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>expected_uplift<span class="sc">:.1%}</span><span class="ss"> points)"</span>)</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="bu">print</span>(<span class="ss">f"Expected monthly value: $</span><span class="sc">{</span>expected_monthly_value<span class="sc">:,.0f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>We see that the expected uplift is -0.030 (-3.0% points), indicating that, on average, the new feature is expected to decrease the conversion rate by 3 percentage points. The expected financial consequence of deploying the new feature is a loss of $1,717 per month</p>
<p>The data suggests that deploying the new feature would likely result in an Expected Monthly Loss of $1,717. This financial quantification is the most compelling reason to reject the new feature based on conversion rate performance.</p>
<p>The decision to proceed should only be considered if the feature provides other, unquantified benefits (e.g., improved customer retention, compliance, or brand value) that are estimated to be worth more than $1,717 per month.</p>
</section>
</section>
<section id="prior-sensitivity-analysis" class="level4">
<h4 class="anchored" data-anchor-id="prior-sensitivity-analysis">Prior sensitivity analysis</h4>
<p>Assessing how the <strong>choice of prior influences the final decision</strong> is important. This transparency is a key strength of <strong>Bayesian modeling</strong>, as it allows testing every assumption. Thus, one must determine how much the choice of prior affects the outcome by comparing several <strong>Beta priors</strong>. These comparisons will include priors from very optimistic (expecting a <span class="math inline">15\%</span> conversion rate) to skeptical (expecting only <span class="math inline">4\%</span>), plus an <strong>uninformative prior</strong> that lets the data speak entirely for itself.</p>
<div id="57" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a></span>
<span id="cb17-2"><a href="#cb17-2"></a>priors_to_test <span class="op">=</span> [</span>
<span id="cb17-3"><a href="#cb17-3"></a>    (<span class="st">"Very Optimistic"</span>, <span class="dv">15</span>, <span class="dv">85</span>),    <span class="co"># Believes 15% conversion rate</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>    (<span class="st">"Optimistic"</span>, <span class="dv">12</span>, <span class="dv">88</span>),         <span class="co"># Believes 12% conversion rate  </span></span>
<span id="cb17-5"><a href="#cb17-5"></a>    (<span class="st">"Historical Based"</span>, <span class="dv">8</span>, <span class="dv">92</span>),    <span class="co"># Our original prior (8%)</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>    (<span class="st">'Strong Historical'</span>, <span class="dv">80</span>, <span class="dv">920</span>),      <span class="co"># Mean = 0.08, ESS = 1000</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>    (<span class="st">"Skeptical"</span>, <span class="dv">4</span>, <span class="dv">96</span>),           <span class="co"># Believes 4% conversion rate</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>    (<span class="st">"Uninformative"</span>, <span class="dv">1</span>, <span class="dv">1</span>),        <span class="co"># Let data dominate completely</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>]</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a>sensitivity_results <span class="op">=</span> []</span>
<span id="cb17-12"><a href="#cb17-12"></a>traces_to_comprare <span class="op">=</span> []</span>
<span id="cb17-13"><a href="#cb17-13"></a></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="cf">for</span> idx, (prior_name, alpha, beta) <span class="kw">in</span> <span class="bu">enumerate</span>(priors_to_test):</span>
<span id="cb17-15"><a href="#cb17-15"></a>    <span class="cf">with</span> pm.Model() <span class="im">as</span> model:</span>
<span id="cb17-16"><a href="#cb17-16"></a>        conversion_rate <span class="op">=</span> pm.Beta(<span class="st">"conversion_rate"</span>, alpha<span class="op">=</span>alpha, beta<span class="op">=</span>beta)</span>
<span id="cb17-17"><a href="#cb17-17"></a>        obs <span class="op">=</span> pm.Binomial(<span class="st">"observations"</span>, n<span class="op">=</span>visitors, p<span class="op">=</span>conversion_rate, observed<span class="op">=</span>conversions)</span>
<span id="cb17-18"><a href="#cb17-18"></a>        trace <span class="op">=</span> pm.sample(<span class="dv">2000</span>, tune<span class="op">=</span><span class="dv">1000</span>, chains<span class="op">=</span><span class="dv">4</span>, random_seed<span class="op">=</span><span class="dv">42</span>, return_inferencedata<span class="op">=</span><span class="va">True</span>, progressbar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-19"><a href="#cb17-19"></a>        </span>
<span id="cb17-20"><a href="#cb17-20"></a> </span>
<span id="cb17-21"><a href="#cb17-21"></a>    posterior_samples <span class="op">=</span> trace.posterior.stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb17-22"><a href="#cb17-22"></a>    conversion_samples<span class="op">=</span>posterior_samples[<span class="st">'conversion_rate'</span>].values</span>
<span id="cb17-23"><a href="#cb17-23"></a>    expected_uplift <span class="op">=</span> conversion_samples.mean() <span class="op">-</span> historical_baseline</span>
<span id="cb17-24"><a href="#cb17-24"></a>    expected_additional_conversions <span class="op">=</span> monthly_visitors <span class="op">*</span> expected_uplift</span>
<span id="cb17-25"><a href="#cb17-25"></a>    expected_monthly_value <span class="op">=</span> expected_additional_conversions <span class="op">*</span> conversion_value</span>
<span id="cb17-26"><a href="#cb17-26"></a></span>
<span id="cb17-27"><a href="#cb17-27"></a></span>
<span id="cb17-28"><a href="#cb17-28"></a>    posterior_mean <span class="op">=</span> conversion_samples.mean()</span>
<span id="cb17-29"><a href="#cb17-29"></a>    posterior_std <span class="op">=</span> conversion_samples.std()</span>
<span id="cb17-30"><a href="#cb17-30"></a>    prior_std <span class="op">=</span> np.sqrt((alpha <span class="op">*</span> beta) <span class="op">/</span> ((alpha <span class="op">+</span> beta)<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> (alpha <span class="op">+</span> beta <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb17-31"><a href="#cb17-31"></a>    prob_better <span class="op">=</span> (conversion_samples <span class="op">&gt;</span> historical_baseline).mean()</span>
<span id="cb17-32"><a href="#cb17-32"></a>    uncertainty_reduction <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, (prior_std <span class="op">-</span> posterior_std) <span class="op">/</span> prior_std)</span>
<span id="cb17-33"><a href="#cb17-33"></a>    </span>
<span id="cb17-34"><a href="#cb17-34"></a>    df <span class="op">=</span> pd.DataFrame({<span class="st">"Prior"</span>: prior_name,</span>
<span id="cb17-35"><a href="#cb17-35"></a>                       <span class="st">"Posterior"</span>: conversion_samples}</span>
<span id="cb17-36"><a href="#cb17-36"></a>                       )</span>
<span id="cb17-37"><a href="#cb17-37"></a>    </span>
<span id="cb17-38"><a href="#cb17-38"></a>    sensitivity_results.append({</span>
<span id="cb17-39"><a href="#cb17-39"></a>        <span class="st">'Prior_Belief'</span>: prior_name,</span>
<span id="cb17-40"><a href="#cb17-40"></a>        <span class="st">'Prior_Parameters'</span>: <span class="ss">f"Beta(</span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>beta<span class="sc">}</span><span class="ss">)"</span>,</span>
<span id="cb17-41"><a href="#cb17-41"></a>        <span class="st">'Prior_Mean'</span>: <span class="ss">f"</span><span class="sc">{</span>alpha<span class="op">/</span>(alpha<span class="op">+</span>beta)<span class="sc">:.3f}</span><span class="ss">"</span>,</span>
<span id="cb17-42"><a href="#cb17-42"></a>        <span class="st">'Posterior_Mean'</span>: <span class="ss">f"</span><span class="sc">{</span>posterior_mean<span class="sc">:.3f}</span><span class="ss">"</span>,</span>
<span id="cb17-43"><a href="#cb17-43"></a>        <span class="st">'Prob_Better'</span>: <span class="ss">f"</span><span class="sc">{</span>prob_better<span class="sc">:.1%}</span><span class="ss">"</span>,</span>
<span id="cb17-44"><a href="#cb17-44"></a>        <span class="st">"Expected_uplift"</span>: <span class="ss">f"$</span><span class="sc">{</span>expected_uplift<span class="sc">:.1%}</span><span class="ss">"</span>,</span>
<span id="cb17-45"><a href="#cb17-45"></a>        <span class="st">"Expected_monthly_value"</span>: <span class="ss">f"$</span><span class="sc">{</span>expected_monthly_value<span class="sc">:,.0f}</span><span class="ss">"</span>,</span>
<span id="cb17-46"><a href="#cb17-46"></a>        <span class="st">'Uncertainty_Reduction'</span>: <span class="ss">f"</span><span class="sc">{</span>uncertainty_reduction<span class="sc">:.1%}</span><span class="ss">"</span>,</span>
<span id="cb17-47"><a href="#cb17-47"></a>        <span class="st">'Data_Influence'</span>: <span class="st">'Strong'</span> <span class="cf">if</span> uncertainty_reduction <span class="op">&gt;</span> <span class="fl">0.8</span> <span class="cf">else</span> <span class="st">'Moderate'</span></span>
<span id="cb17-48"><a href="#cb17-48"></a>    })</span>
<span id="cb17-49"><a href="#cb17-49"></a>    traces_to_comprare.append(df) </span>
<span id="cb17-50"><a href="#cb17-50"></a>sensitivity_df <span class="op">=</span> pd.DataFrame(sensitivity_results)</span>
<span id="cb17-51"><a href="#cb17-51"></a>traces_to_comprare<span class="op">=</span>pd.concat(traces_to_comprare)</span>
<span id="cb17-52"><a href="#cb17-52"></a>clear_output()</span>
<span id="cb17-53"><a href="#cb17-53"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Let first visualise the different priors</p>
<div id="59" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>domain <span class="op">=</span> [<span class="st">"Very Optimistic"</span>, <span class="st">"Optimistic"</span>, <span class="st">"Historical Based"</span>, <span class="st">"Strong Historical"</span>, <span class="st">"Skeptical"</span>, <span class="st">"Uninformative"</span>]</span>
<span id="cb18-2"><a href="#cb18-2"></a>reference_data <span class="op">=</span> pd.DataFrame([</span>
<span id="cb18-3"><a href="#cb18-3"></a>    {<span class="st">'x'</span>: <span class="fl">0.08</span>, <span class="st">'label'</span>: <span class="st">'Old Feature CR (8%)'</span>, <span class="st">'color'</span>: <span class="st">'red'</span>, <span class="st">'label_x'</span>: <span class="fl">0.08</span>},</span>
<span id="cb18-4"><a href="#cb18-4"></a>    {<span class="st">'x'</span>: <span class="fl">0.075</span>, <span class="st">'label'</span>: <span class="st">'New Feature CR (7.5%)'</span>, <span class="st">'color'</span>: <span class="st">'green'</span>, <span class="st">'label_x'</span>: <span class="fl">0.075</span>}</span>
<span id="cb18-5"><a href="#cb18-5"></a>])</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a>chart <span class="op">=</span> alt.Chart(traces_to_comprare).transform_density(density<span class="op">=</span><span class="st">'Posterior'</span>, groupby<span class="op">=</span>[<span class="st">'Prior'</span>], as_<span class="op">=</span>[<span class="st">'Posterior'</span>, <span class="st">'density'</span>])<span class="op">\</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>    .mark_line(opacity<span class="op">=</span><span class="fl">0.5</span>)<span class="op">\</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>    .encode(x<span class="op">=</span><span class="st">'Posterior:Q'</span>, </span>
<span id="cb18-11"><a href="#cb18-11"></a>            y<span class="op">=</span><span class="st">'density:Q'</span>, </span>
<span id="cb18-12"><a href="#cb18-12"></a>            color<span class="op">=</span>alt.Color(<span class="st">"Prior:N"</span>).scale(domain<span class="op">=</span>domain, <span class="bu">range</span><span class="op">=</span>colors[:<span class="bu">len</span>(domain)])</span>
<span id="cb18-13"><a href="#cb18-13"></a>            )</span>
<span id="cb18-14"><a href="#cb18-14"></a></span>
<span id="cb18-15"><a href="#cb18-15"></a>reference_lines <span class="op">=</span> alt.Chart(reference_data).mark_rule(</span>
<span id="cb18-16"><a href="#cb18-16"></a>    strokeDash<span class="op">=</span>[<span class="dv">5</span>, <span class="dv">5</span>], <span class="co"># Dashed line</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>    size<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb18-18"><a href="#cb18-18"></a>).encode(</span>
<span id="cb18-19"><a href="#cb18-19"></a>    x<span class="op">=</span><span class="st">'x:Q'</span>,</span>
<span id="cb18-20"><a href="#cb18-20"></a>    color<span class="op">=</span>alt.Color(<span class="st">'label:N'</span>, </span>
<span id="cb18-21"><a href="#cb18-21"></a>                    scale<span class="op">=</span>alt.Scale(domain<span class="op">=</span>reference_data[<span class="st">'label'</span>].tolist(), </span>
<span id="cb18-22"><a href="#cb18-22"></a>                                    <span class="bu">range</span><span class="op">=</span>reference_data[<span class="st">'color'</span>].tolist()),</span>
<span id="cb18-23"><a href="#cb18-23"></a>                    legend<span class="op">=</span>alt.Legend(title<span class="op">=</span><span class="st">"Conversion Rate"</span>))</span>
<span id="cb18-24"><a href="#cb18-24"></a>)</span>
<span id="cb18-25"><a href="#cb18-25"></a></span>
<span id="cb18-26"><a href="#cb18-26"></a></span>
<span id="cb18-27"><a href="#cb18-27"></a>final<span class="op">=</span>chart <span class="op">+</span> reference_lines </span>
<span id="cb18-28"><a href="#cb18-28"></a>final<span class="op">=</span>final.properties(title<span class="op">=</span><span class="st">'Posterior Distributions by Prior Belief'</span>, width<span class="op">=</span><span class="dv">700</span>, height<span class="op">=</span><span class="dv">200</span>).configure_axis(</span>
<span id="cb18-29"><a href="#cb18-29"></a>    <span class="co"># Set grid to False to remove all grid lines</span></span>
<span id="cb18-30"><a href="#cb18-30"></a>    grid<span class="op">=</span><span class="va">False</span></span>
<span id="cb18-31"><a href="#cb18-31"></a>).configure_view(</span>
<span id="cb18-32"><a href="#cb18-32"></a>    <span class="co"># Optional: Remove the surrounding border of the plot area</span></span>
<span id="cb18-33"><a href="#cb18-33"></a>    strokeWidth<span class="op">=</span><span class="dv">0</span> </span>
<span id="cb18-34"><a href="#cb18-34"></a>)</span>
<span id="cb18-35"><a href="#cb18-35"></a>final.save(<span class="st">'posterior_sensitivity.pdf'</span>)</span>
<span id="cb18-36"><a href="#cb18-36"></a>final</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>The figure above show Posterior belief distributions under different prior assumptions. Each curve in the figure represents a posterior distribution for the conversion rate under a different prior assumption. The horizontal axis shows possible conversion rates, and the vertical axis shows how plausible each value is after combining the prior belief with the observed data.</p>
<p>Despite very different starting assumptions, the posterior estimates converge around 7‚Äì10%, showing that the data provide a stable, consistent signal largely independent of the chosen prior. All reasonable priors converge to the same conclusion: <strong>the new feature likely isn‚Äôt better than the old one</strong>.</p>
<p>To support decision-making, we compile a summary table comparing key metrics across these prior choices.</p>
<div id="62" class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Create sensitivity analysis table</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>sensitivity_table <span class="op">=</span> (</span>
<span id="cb19-3"><a href="#cb19-3"></a>    GT(sensitivity_df)</span>
<span id="cb19-4"><a href="#cb19-4"></a>    .tab_header(</span>
<span id="cb19-5"><a href="#cb19-5"></a>        title<span class="op">=</span><span class="st">"Sensitivity Analysis: Impact of Prior Beliefs"</span>,</span>
<span id="cb19-6"><a href="#cb19-6"></a>        subtitle<span class="op">=</span><span class="st">"How Different Starting Assumptions Affect Final Conclusions"</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>    )</span>
<span id="cb19-8"><a href="#cb19-8"></a>    .cols_label(</span>
<span id="cb19-9"><a href="#cb19-9"></a>        Prior_Belief<span class="op">=</span><span class="st">"Prior Belief"</span>,</span>
<span id="cb19-10"><a href="#cb19-10"></a>        Prior_Parameters<span class="op">=</span><span class="st">"Prior Distribution"</span>, </span>
<span id="cb19-11"><a href="#cb19-11"></a>        Prior_Mean<span class="op">=</span><span class="st">"Prior Mean"</span>,</span>
<span id="cb19-12"><a href="#cb19-12"></a>        Posterior_Mean<span class="op">=</span><span class="st">"Posterior Mean"</span>,</span>
<span id="cb19-13"><a href="#cb19-13"></a>        Prob_Better<span class="op">=</span><span class="st">"Prob. Better"</span>,</span>
<span id="cb19-14"><a href="#cb19-14"></a>        Data_Influence<span class="op">=</span><span class="st">"Data Influence"</span>,</span>
<span id="cb19-15"><a href="#cb19-15"></a>        Uncertainty_Reduction<span class="op">=</span><span class="st">"Uncertainty Reduction"</span>,</span>
<span id="cb19-16"><a href="#cb19-16"></a>        Expected_uplift<span class="op">=</span><span class="st">"Expected Uplift"</span>,</span>
<span id="cb19-17"><a href="#cb19-17"></a>        Expected_monthly_value<span class="op">=</span><span class="st">"Expected Monthly Value"</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>    )</span>
<span id="cb19-19"><a href="#cb19-19"></a>    .data_color(</span>
<span id="cb19-20"><a href="#cb19-20"></a>        columns<span class="op">=</span>[<span class="st">"Prob_Better"</span>],</span>
<span id="cb19-21"><a href="#cb19-21"></a>        palette<span class="op">=</span>[<span class="st">"#C73E1D"</span>, <span class="st">"#F18F01"</span>, <span class="st">"#2E8B57"</span>],</span>
<span id="cb19-22"><a href="#cb19-22"></a>        domain<span class="op">=</span>[<span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>]</span>
<span id="cb19-23"><a href="#cb19-23"></a>    )</span>
<span id="cb19-24"><a href="#cb19-24"></a>    .data_color(</span>
<span id="cb19-25"><a href="#cb19-25"></a>        columns<span class="op">=</span>[<span class="st">"Data_Influence"</span>],</span>
<span id="cb19-26"><a href="#cb19-26"></a>        palette<span class="op">=</span>[<span class="st">"#2E8B57"</span>, <span class="st">"#F18F01"</span>, <span class="st">"#C73E1D"</span>],</span>
<span id="cb19-27"><a href="#cb19-27"></a>        domain<span class="op">=</span>[<span class="st">"Strong"</span>, <span class="st">"Moderate"</span>, <span class="st">"Weak"</span>]</span>
<span id="cb19-28"><a href="#cb19-28"></a>    ).data_color(</span>
<span id="cb19-29"><a href="#cb19-29"></a>        columns<span class="op">=</span>[<span class="st">"Uncertainty Reduction"</span>],</span>
<span id="cb19-30"><a href="#cb19-30"></a>        palette<span class="op">=</span>[<span class="st">"#C73E1D"</span>, <span class="st">"#F18F01"</span>, <span class="st">"#2E8B57"</span>],</span>
<span id="cb19-31"><a href="#cb19-31"></a>        domain<span class="op">=</span>[<span class="fl">0.0</span>, <span class="dv">80</span>, <span class="dv">100</span>]</span>
<span id="cb19-32"><a href="#cb19-32"></a>    ).tab_source_note(</span>
<span id="cb19-33"><a href="#cb19-33"></a>        <span class="st">"Analysis shows robustness of conclusions to different prior assumptions ‚Ä¢ "</span></span>
<span id="cb19-34"><a href="#cb19-34"></a>        <span class="st">"Even skeptical priors converge toward data-driven truth"</span></span>
<span id="cb19-35"><a href="#cb19-35"></a>    )</span>
<span id="cb19-36"><a href="#cb19-36"></a>    .tab_options(</span>
<span id="cb19-37"><a href="#cb19-37"></a>        table_width<span class="op">=</span><span class="st">"100%"</span>,</span>
<span id="cb19-38"><a href="#cb19-38"></a>    )</span>
<span id="cb19-39"><a href="#cb19-39"></a>)</span>
<span id="cb19-40"><a href="#cb19-40"></a>clear_output()</span>
<span id="cb19-41"><a href="#cb19-41"></a>sensitivity_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Key observations:</p>
<ol type="1">
<li><p><strong>Prior Pull</strong>: The data moderate extreme beliefs. The very optimistic prior (0.150) is pulled down to 0.100, while the skeptical prior (0.040) rises to 0.064‚Äîdemonstrating how new evidence shifts expectations toward a central value.</p></li>
<li><p><strong>Prior Strength vs.&nbsp;Data Influence:</strong> The Strong Historical prior (Beta(80, 920)) and Uninformative prior (Beta(1, 1)) yield similar posteriors (~0.079, ~45% Prob_Better), but for opposite reasons. The former is dominated by prior belief; the latter, by data‚Äîshowing that strong evidence can overcome weak or missing priors.</p></li>
<li><p><strong>Impact on Decision Metrics:</strong>: The Very Optimistic prior suggests an 88% Prob_Better and +$9.9k expected value, favoring a launch. The Skeptical prior predicts only 12% Prob_Better and ‚Äì$8.2k, suggesting the opposite. Even moderate priors (e.g., 40‚Äì47%) could tip a go/no-go decision depending on the threshold.</p></li>
</ol>
</section>
</section>
<section id="common-bayesian-pitfalls-and-best-practices" class="level3">
<h3 class="anchored" data-anchor-id="common-bayesian-pitfalls-and-best-practices">Common bayesian pitfalls and best practices</h3>
<p>While Bayesian modeling provides a powerful framework for decision-making under uncertainty, several common mistakes can reduce its effectiveness.</p>
<blockquote class="blockquote">
<p>The first is overconfident priors, where excessively strong prior assumptions prevent new data from influencing the results. This issue is best mitigated by starting with weak or moderately informative priors and refining them as more evidence becomes available.</p>
</blockquote>
<blockquote class="blockquote">
<p>A second pitfall is ignoring prior sensitivity. Conclusions may shift significantly depending on the chosen prior distribution, so it is essential to conduct sensitivity analyses using multiple plausible priors to ensure that insights are robust.</p>
</blockquote>
<blockquote class="blockquote">
<p>The third major issue involves misinterpreting probability. A statement such as ‚Äú95% probability‚Äù does not imply absolute certainty; rather, it reflects the degree of belief given the available data and assumptions. Probabilities in Bayesian analysis are best interpreted in terms of relative confidence, risk, and decision trade-offs.</p>
</blockquote>
</section>
<section id="next-steps-in-the-bayesian-journey" class="level3">
<h3 class="anchored" data-anchor-id="next-steps-in-the-bayesian-journey">Next steps in the bayesian journey</h3>
<p>We have laid the groundwork by exploring the core components of the Bayesian approach. The subsequent session will focus on advanced practical implementation. We will apply this framework to critical survival analysis problems, modeling the probability and timing of events such as equipment failure.</p>
</section>
<section id="resources-to-continue-learning" class="level3">
<h3 class="anchored" data-anchor-id="resources-to-continue-learning">Resources to continue learning</h3>
<ul>
<li><a href="https://bayesiancomputationbook.com/welcome.html">Bayesian Modeling and Computation in Python</a></li>
<li><a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers">Bayesian Methods for Hackers</a></li>
<li><a href="https://xcelab.net/rm/statistical-rethinking/">Statistical Rethinking</a></li>
<li><a href="https://www.taylorfrancis.com/books/mono/10.1201/9781315372495/doing-bayesian-data-analysis-john-kruschke">Doing Bayesian Data Analysis</a></li>
<li><a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a></li>
<li><a href="https://www.pymc.io/welcome.html">PyMC Documentation</a></li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{faustine2025,
  author = {Faustine, Anthony},
  title = {Understanding {Bayesian} {Thinking} for {Industrial}
    {Applications}},
  date = {2025-10-10},
  url = {https://sambaiga.github.io/pages/blog/posts/2025/10/2025-10-10-bayesion-foundation.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sambaiga\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><i class="bi-cc-circle " style="" role="img" aria-hidden="true"></i> 2025‚Äì2026 Anthony Faustine</span> <span class="faux-block">All content licensed under<br><a href="https://creativecommons.org/licenses/by/4.0/"><i class="bi-cc-circle " style="" role="img" aria-hidden="true"></i> <i class="bi-cc-by " style="" role="img" aria-hidden="true"></i> Creative Commons CC BY 4.0</a></span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block"><i class="bi-orcid " style="" role="img" aria-hidden="true"></i> <strong>ORCID</strong> <a href="https://orcid.org/0000-0002-7838-533X">0000-0002-7838-533X</a></span> <span class="faux-block"><i class="bi-key " style="" role="img" aria-hidden="true"></i> <a href="../../../../../pgp_ath.asc.txt">PGP public key</a> ‚ÄÉ <i class="bi-fingerprint " style="" role="img" aria-hidden="true"></i> Fingerprint:<br><span class="fingerprint">49ACD41443AEBE4C4877B<br> 573E6EBC869F77E2675</span></span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <a href="https://quarto.org/">Quarto</a></span> <span class="faux-block"><a href="https://github.com/sambaiga/sambaiga.github.io">View the source at <i class="bi-github " style="" role="img" aria-hidden="true"></i> GitHub</a></span></p>
</div>
  </div>
</footer>




<script src="../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>